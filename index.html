<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>IMPOSTOR | Juego de Deducción</title>
    <link rel="stylesheet" href="styles.css" />
</head>
<body>

    <!-- PANTALLA PRINCIPAL -->
    <div class="screen" id="pantalla-principal">
        <h1 class="titulo-app">IMPOSTOR</h1>
        <div class="main-menu">
            <div class="card opcion" onclick="mostrarModo('local')">
                <h3>JUEGO LOCAL</h3>
                <p>Un solo dispositivo</p>
            </div>
            <div class="card opcion" onclick="mostrarModo('multijugador')">
                <h3>MULTIJUGADOR ONLINE</h3>
                <p>Conecta con amigos</p>
            </div>
        </div>
    </div>

    <!-- ========== MODO LOCAL ========== -->
    
    <!-- Configuración Local -->
    <div class="screen hidden" id="pantalla-local-config">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <button class="btn-atras" onclick="volverConfigLocal()">← Atrás</button>
            <h2 style="margin:0; color: white;">MODO LOCAL</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="configuracion">
            <label for="cantidadJugadoresLocal">Jugadores (3-15):</label>
            <select id="cantidadJugadoresLocal" class="select-config">
                <option value="3">3</option>
                <option value="4" selected>4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
            </select>
        </div>

        <div class="configuracion">
            <label for="cantidadImpostoresLocal">Impostores:</label>
            <select id="cantidadImpostoresLocal" class="select-config">
                <option value="1">1</option>
                <option value="2">2</option>
            </select>
            <div class="nota">Mínimo 1 por cada 3 jugadores</div>
        </div>

        <div class="configuracion">
            <label for="categoriaLocal">Categoría:</label>
            <select id="categoriaLocal" class="select-config">
                <option value="Futbolistas">Futbolistas</option>
                <option value="Países">Países</option>
                <option value="Objetos">Objetos</option>
            </select>
        </div>

        <div class="row">
            <button onclick="irNombresLocal()">SIGUIENTE</button>
        </div>
    </div>

    <!-- Nombres de Jugadores Local -->
    <div class="screen hidden" id="pantalla-local-nombres">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <button class="btn-atras" onclick="volverConfigLocal()">← Atrás</button>
            <h2 style="margin:0; color: white;">NOMBRES DE JUGADORES</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div id="contenedorNombresLocal" style="margin: 20px 0;"></div>

        <div class="row">
            <button onclick="iniciarJuegoLocal()">COMENZAR JUEGO</button>
        </div>
    </div>

    <!-- Mostrar Jugador Actual Local -->
    <div class="screen hidden" id="pantalla-local-jugador">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <div style="width: 70px;"></div>
            <h2 style="margin:0; color: white;" id="tituloJugadorLocal">TURNO JUGADOR 1</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="info-jugador">
            <div class="nombre-jugador-display" id="nombreJugadorLocal">Jugador 1</div>
            <div class="info-detalle">
                <div class="info-item">
                    <span class="info-label">Categoría:</span>
                    <span id="categoriaNombreLocal" class="info-valor">Objetos</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Impostores:</span>
                    <span id="impostoresNombreLocal" class="info-valor">1</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Jugadores:</span>
                    <span id="totalJugadoresLocal" class="info-valor">4</span>
                </div>
            </div>
        </div>

        <div class="row">
            <button onclick="verPalabraLocal()">VER</button>
        </div>
    </div>

    <!-- Palabra del Jugador Local -->
    <div class="screen hidden" id="pantalla-local-palabra">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <div style="width: 70px;"></div>
            <h2 style="margin:0; color: white;" id="tituloJugadorPalabra">TURNO JUGADOR 1</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="info-jugador">
            <div class="nombre-jugador-display" id="nombreJugadorPalabra">Jugador 1</div>
            <div class="info-detalle">
                <div class="info-item">
                    <span class="info-label">Categoría:</span>
                    <span id="categoriaPalabra" class="info-valor">Objetos</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Impostores:</span>
                    <span id="impostoresPalabra" class="info-valor">1</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Jugadores:</span>
                    <span id="totalJugadoresPalabra" class="info-valor">4</span>
                </div>
            </div>
        </div>

        <div id="palabraJugadorLocal" class="palabra-display">Palabra</div>

        <div class="row">
            <button id="btnSiguienteLocal" onclick="siguienteJugadorLocal()">SIGUIENTE JUGADOR</button>
            <button id="btnFinalizarLocal" class="hidden" onclick="finalizarJuegoLocal()">FINALIZAR</button>
        </div>
    </div>

    <!-- Menú Final Local -->
    <div class="screen hidden" id="pantalla-local-final">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <div style="width: 70px;"></div>
            <h2 style="margin:0; color: white;">JUEGO TERMINADO</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <!-- Contenedor para revelar impostor -->
        <div class="revelar-container">
            <div class="impostor-info hidden" id="impostorRevelado">
                <div class="impostor-titulo">EL IMPOSTOR ES:</div>
                <div id="impostorReveladoTexto" class="impostor-nombre">Jugador 1</div>
            </div>
            
            <div class="row">
                <button onclick="revelarImpostorLocal()">REVELAR IMPOSTOR</button>
            </div>
        </div>

        <div class="row-buttons">
            <button onclick="volveraJugarLocal()">VOLVER A JUGAR</button>
            <button onclick="volverConfiguracionLocal()">CONFIGURACIÓN</button>
        </div>
    </div>

    <!-- ========== MODO MULTIJUGADOR ========== -->
    
    <!-- Paso 1: Nombre -->
    <div class="screen hidden" id="multijugador-nombre">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <button class="btn-atras" onclick="volverPrincipal()">← Atrás</button>
            <h2 style="margin:0; color: white;">MULTIJUGADOR</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="configuracion">
            <label for="nombreJugadorMultijugador">Tu nombre:</label>
            <input type="text" id="nombreJugadorMultijugador" placeholder="Ej: Alex" maxlength="20">
        </div>

        <div class="row">
            <button onclick="continuarMultijugador()">CONTINUAR</button>
        </div>
    </div>

    <!-- Paso 2: Crear o Unirse -->
    <div class="screen hidden" id="multijugador-elegir">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <button class="btn-atras" onclick="volverMultijugadorPrincipal()">← Atrás</button>
            <h2 style="margin:0; color: white;">MULTIJUGADOR</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="main-menu">
            <div class="card opcion" onclick="mostrarCrearSala()">
                <h3>CREAR SALA</h3>
                <p>Nueva sala con código</p>
            </div>
            <div class="card opcion" onclick="mostrarUnirseSala()">
                <h3>UNIRSE A SALA</h3>
                <p>Con código existente</p>
            </div>
        </div>
    </div>

    <!-- Crear Sala -->
    <div class="screen hidden" id="multijugador-crear">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <button class="btn-atras" onclick="volverElegirMultijugador()">← Atrás</button>
            <div style="text-align: center;">
                <h2 style="margin:0; color: white;">CREAR SALA</h2>
                <div style="font-size: 12px; color: #aaa;">ID: <span id="codigoSalaCreador">-</span></div>
            </div>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="configuracion">
            <label for="cantidadJugadoresMultijugador">Jugadores (3-15):</label>
            <select id="cantidadJugadoresMultijugador" class="select-config">
                <option value="3">3</option>
                <option value="4" selected>4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
            </select>
        </div>

        <div class="configuracion">
            <label for="cantidadImpostoresMultijugador">Impostores:</label>
            <select id="cantidadImpostoresMultijugador" class="select-config">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
            <div class="nota">Mínimo 1 por cada 3 jugadores</div>
        </div>

        <div class="configuracion">
            <label for="categoriaMultijugador">Categoría:</label>
            <select id="categoriaMultijugador" class="select-config">
                <option value="Futbolistas">Futbolistas</option>
                <option value="Países">Países</option>
                <option value="Objetos">Objetos</option>
            </select>
        </div>

        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; margin: 15px 0; border: 1px solid #333;">
            <h3 style="margin-top: 0; color: white;">JUGADORES (<span id="jugadoresActuales">0</span>/<span id="maxJugadoresDisplay">4</span>)</h3>
            <div id="listaJugadoresLobby"></div>
        </div>

        <div class="row">
            <button id="btnIniciarJuego" onclick="iniciarJuegoMultijugador()" disabled>INICIAR JUEGO</button>
        </div>
    </div>

    <!-- Unirse a Sala -->
    <div class="screen hidden" id="multijugador-unirse">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <button class="btn-atras" onclick="volverElegirMultijugador()">← Atrás</button>
            <h2 style="margin:0; color: white;">UNIRSE A SALA</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="configuracion">
            <label for="codigoSalaUnirse">Código de Sala:</label>
            <input type="text" id="codigoSalaUnirse" placeholder="Ej: ABC12" maxlength="5" style="text-transform: uppercase;">
        </div>

        <div class="row">
            <button onclick="unirseSala()">UNIRSE</button>
        </div>
    </div>

    <!-- Sala Unido (para no creadores) -->
    <div class="screen hidden" id="multijugador-sala-unido">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
            <div style="text-align: center;">
                <h2 style="margin:0; color: white;">SALA</h2>
                <div style="font-size: 12px; color: #aaa;">ID: <span id="codigoSalaUnido">-</span></div>
            </div>
            <div style="width: 70px;"></div>
        </div>

        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; margin: 15px 0; border: 1px solid #333;">
            <h3 style="margin-top: 0; color: white;">CONFIGURACIÓN</h3>
            <div id="configResumen"></div>
        </div>

        <div style="background: #1a1a1a; padding: 15px; border-radius: 8px; border: 1px solid #333;">
            <h3 style="margin-top: 0; color: white;">JUGADORES (<span id="jugadoresActualesUnido">0</span>/<span id="maxJugadoresDisplayUnido">4</span>)</h3>
            <div id="listaJugadoresUnido"></div>
        </div>

        <div style="margin: 40px 0; text-align: center;">
            <div style="font-size: 18px; color: #ccc;">Esperando al creador...</div>
            <div style="margin-top: 10px; color: #777;">El creador iniciará el juego</div>
        </div>
    </div>

    <!-- Pantalla para VER la Palabra -->
    <div class="screen hidden" id="multijugador-ver-palabra">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <div style="width: 70px;"></div>
            <h2 style="margin:0; color: white;" id="tituloJugadorMultijugadorVer">ID: -</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="info-jugador">
            <div class="nombre-jugador-display" id="nombreJugadorMultijugadorVer">Jugador</div>
            <div class="info-detalle">
                <div class="info-item">
                    <span class="info-label">Categoría:</span>
                    <span id="categoriaJugadorMultijugadorVer" class="info-valor">Categoría</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Impostores:</span>
                    <span id="impostoresJugadorMultijugadorVer" class="info-valor">1</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Jugadores:</span>
                    <span id="totalJugadoresMultijugadorVer" class="info-valor">4</span>
                </div>
            </div>
        </div>

        <div id="textoPalabraOculto" class="palabra-display" style="color: #ccc; border-color: #444;">
            ???
        </div>

        <div class="row">
            <button id="btnVerPalabraMultijugador" onclick="verPalabraMultijugador()">VER</button>
        </div>
    </div>

    <!-- Pantalla con Palabra Revelada -->
    <div class="screen hidden" id="multijugador-palabra-revelada">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <div style="width: 70px;"></div>
            <h2 style="margin:0; color: white;" id="tituloJugadorMultijugadorRevelado">ID: -</h2>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <div class="info-jugador">
            <div class="nombre-jugador-display" id="nombreJugadorMultijugadorRevelado">Jugador</div>
            <div class="info-detalle">
                <div class="info-item">
                    <span class="info-label">Categoría:</span>
                    <span id="categoriaJugadorMultijugadorRevelado" class="info-valor">Categoría</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Impostores:</span>
                    <span id="impostoresJugadorMultijugadorRevelado" class="info-valor">1</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Jugadores:</span>
                    <span id="totalJugadoresMultijugadorRevelado" class="info-valor">4</span>
                </div>
            </div>
        </div>

        <div id="textoPalabraRevelada" class="palabra-display">Palabra</div>

        <div class="row">
            <button id="btnListoMultijugador" onclick="marcarListo()">LISTO</button>
        </div>
    </div>

    <!-- Pantalla Final Multijugador -->
    <div class="screen hidden" id="multijugador-final">
        <div style="display:flex; align-items:center; justify-content:space-between">
            <div style="width: 70px;"></div>
            <div style="text-align: center;">
                <h2 style="margin:0; color: white;">FIN DEL JUEGO</h2>
                <div style="font-size: 12px; color: #aaa;">ID: <span id="codigoTextoFinal">-</span></div>
            </div>
            <button class="btn-atras" onclick="confirmarSalirSala()">INICIO</button>
        </div>

        <!-- Contenedor para revelar impostor -->
        <div class="revelar-container">
            <div class="impostor-info hidden" id="impostorReveladoMultijugador">
                <div class="impostor-titulo" id="impostorTituloMultijugador">EL IMPOSTOR ES:</div>
                <div id="impostorReveladoTextoMultijugador" class="impostor-nombre">Jugador</div>
            </div>
            
            <div class="row">
                <button id="btnVotarImpostor" onclick="votarImpostor()">REVELAR IMPOSTOR</button>
            </div>
        </div>

        <div class="row-buttons" id="opcionesCreador" style="display: none;">
            <button onclick="volveraJugarMultijugador()">VOLVER A JUGAR</button>
            <button onclick="volverConfiguracionMultijugador()">CONFIGURACIÓN</button>
        </div>
    </div>

    <!-- Modal de Confirmación -->
    <div id="confirmModal" class="modal-salida hidden">
        <div class="modal-box">
            <h3 style="margin-top: 0; color: white;">CONFIRMACIÓN</h3>
            <p id="confirmText" style="font-size: 16px; color: #ccc;">¿Estás seguro que quieres salir?</p>
            <div class="modal-buttons">
                <button onclick="confirmSalir(true)">SALIR</button>
                <button onclick="confirmSalir(false)">CANCELAR</button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="script.js"></script>
</body>
</html>